% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/create-enzyme.R
\name{create_enzyme}
\alias{create_enzyme}
\title{Create A Custom Enzyme}
\usage{
create_enzyme(name, rules, type, species)
}
\arguments{
\item{name}{The name of the enzyme.}

\item{rules}{A list of enzyme rules, each rule being a list with the following fields:
\itemize{
\item \code{acceptor}: A \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} scalar or any structure string supported by \code{\link[glyparse:auto_parse]{glyparse::auto_parse()}},
the motif recognized by the enzyme.
\item \code{acceptor_alignment}: A character string, the alignment of the \code{acceptor}.
Possible values are "substructure", "core", "terminal" and "whole".
See \code{\link[glymotif:have_motif]{glymotif::have_motif()}} for details.
\item \code{rejects}: A \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} vector or any structure character vector supported by \code{\link[glyparse:auto_parse]{glyparse::auto_parse()}},
the motifs that the enzyme rejects. Can also be \code{NULL}.
\item \code{product}: A \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} scalar or any structure string supported by \code{\link[glyparse:auto_parse]{glyparse::auto_parse()}},
the product generated by the enzyme.
}}

\item{type}{The type of the enzyme, "GT" for glycosyltransferase or "GH" for glycoside hydrolase.}

\item{species}{The species of the enzyme. Default is "human".
Currently no validation is done on the species.
This field is only used for information purposes.}
}
\value{
A \code{glyenzy_enzyme} object.
}
\description{
This function creates a custom enzyme object,
which can be used in all functions in this package that accept an enzyme argument.
Most of the time, you can use \code{\link[=enzyme]{enzyme()}} with a gene symbol to get a predefined enzyme,
or just use the gene symbol directly in function arguments.
Use this function only when you need to create an enzyme with custom rules.
See the "Enzyme rules" section below for more details.
}
\section{Enzyme rules}{
The enzyme rules are the core of an enzyme object.
Each rule defines one possible reaction of an enzyme,
and an enzyme can have multiple rules.

We now explain each field of an enzyme rule in detail.
\subsection{acceptor}{

The \code{acceptor} is the glycan motif (substructure) that the enzyme recognizes.
It can be as simple as a single residue, like \verb{Man(a1-},
or a more complex motif, like \verb{Man(a1-3)[Man(a1-6)]Man(b1-4)GlcNAc(b1-4)GlcNAc(b1-}.
Note that the acceptor does not define where the enzyme acts on,
which is determined collectively by the \code{acceptor} and \code{product} fields.
}

\subsection{acceptor_alignment}{

Under the hood, the \code{acceptor} is detected by \code{glymotif::match_motif()}.
To match a motif, we need to specify the alignment of the motif.
Possible values are "substructure", "core", "terminal" and "whole".
See \code{\link[glymotif:have_motif]{glymotif::have_motif()}} for details.
}

\subsection{rejects}{

Some enzymes are really picky.
They will reject to act on certain glycans if some motifs are present,
even if the acceptor is perfectly matched.
For example, if we want to define an enzyme that adds a Neu5Ac residue to the Gal residue
of a \verb{Gal(b1-4)GlcNAc(b1-} motif,
but only when there is no a1-3 Fuc on that GlcNAc,
we can set \code{"Gal(b1-4)GlcNAc(b1-"} as the \code{acceptor} and \code{"Fuc(a1-3)[Gal(b1-4)]GlcNAc(b1-"} as the \code{rejects}.
You can provide multiple rejects as a vector.
For example, if we want to reject \verb{Gal(b1-4)GlcNAc(b1-} with either
a1-3 Fuc on GlcNAc or a1-2 Fuc on Gal,
we can set \code{c("Fuc(a1-3)[Gal(b1-4)]GlcNAc(b1-", "Fuc(a1-2)Gal(b1-4)GlcNAc(b1-")} as the \code{rejects}.

Note that here are some restrictions on the \code{rejects}:
\itemize{
\item When \code{acceptor_alignment} is "whole", \code{rejects} cannot be set.
\item The \code{acceptor} must be the substructure of all \code{rejects}.
For example, in the a1-3 Fuc example above, you cannot just set \code{"Fuc(a1-3)GlcNAc(b1-"} as the \code{rejects},
because \code{"Gal(b1-4)GlcNAc(b1-"} (the acceptor) is not the substructure of \code{"Fuc(a1-3)GlcNAc(b1-"} (the reject).
\item \code{rejects} cannot be the same structure as \code{acceptor}.
}

If \code{rejects} is \code{NULL}, it means the enzyme does not reject any motifs.
}

\subsection{product}{

The \code{product} is what the \code{acceptor} is transformed into by the enzyme.
For glycosyltransferases (GTs), the \code{product} should have exactly one more residue than the \code{acceptor}.
For glycoside hydrolases (GHs), the \code{product} should have exactly one less residue than the \code{acceptor}.
If you have multiple possible products, put them in different rules.
Take the same example above, if we want to add a Neu5Ac residue to the Gal residue
of a \verb{Gal(b1-4)GlcNAc(b1-} motif,
we can set \code{"Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-"} as the \code{product}.
}
}

\examples{
library(glyrepr)

# Create a custom enzyme that adds a Neu5Ac residue to the Gal residue
create_enzyme(
  name = "MySiaT",
  rules = list(
    list(
      acceptor = "Gal(b1-4)GlcNAc(b1-",
      acceptor_alignment = "terminal",
      rejects = NULL,
      product = "Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-"
    )
  ),
  type = "GT",
  species = "human"
)

# Create a custom enzyme that removes a Gal residue from a Gal(b1-4)GlcNAc(b1-` motif
create_enzyme(
  name = "MyGalH",
  rules = list(
    list(
      acceptor = "Gal(b1-4)GlcNAc(b1-",
      acceptor_alignment = "terminal",
      rejects = NULL,
      product = "GlcNAc(b1-"
    )
  ),
  type = "GH",
  species = "human"
)

# Create a custom enzyme with rejects
create_enzyme(
  name = "MySiaT",
  rules = list(
    list(
      acceptor = "Gal(b1-4)GlcNAc(b1-",
      acceptor_alignment = "terminal",
      rejects = c(
        # Reject a1-3 Fuc on GlcNAc
        "Fuc(a1-3)[Gal(b1-4)]GlcNAc(b1-",
        # Reject a1-2 Fuc on Gal
        "Fuc(a1-2)Gal(b1-4)GlcNAc(b1-"
      ),
      product = "Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-"
    )
  ),
  type = "GT",
  species = "human"
)

# Create a custom enzyme with more than one rule
create_enzyme(
  name = "MySiaT",
  rules = list(
    list(
      acceptor = "Gal(b1-4)GlcNAc(b1-",
      acceptor_alignment = "terminal",
      rejects = NULL,
      product = "Neu5Ac(a2-3)Gal(b1-4)GlcNAc(b1-"
    ),
    # same acceptor, different product
    list(
      acceptor = "Gal(b1-4)GlcNAc(b1-",
      acceptor_alignment = "terminal",
      rejects = NULL,
      product = "Neu5Gc(a2-3)Gal(b1-4)GlcNAc(b1-"
    )
  ),
  type = "GT",
  species = "human"
)
}
\seealso{
\code{\link[=enzyme]{enzyme()}}
}
