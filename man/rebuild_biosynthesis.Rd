% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rebuild-biosynthesis.R
\name{rebuild_biosynthesis}
\alias{rebuild_biosynthesis}
\title{Rebuild the Biosynthetic Path of Glycans}
\usage{
rebuild_biosynthesis(glycans, enzymes = NULL, max_steps = 20, filter = NULL)
}
\arguments{
\item{glycans}{A \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} vector, or a character vector
of strings supported by \code{\link[glyparse:auto_parse]{glyparse::auto_parse()}}. Can also be a single glycan.}

\item{enzymes}{A character vector of gene symbols, or a list of \code{\link[=enzyme]{enzyme()}} objects.
If \code{NULL} (default), all available enzymes will be used.}

\item{max_steps}{Integer, maximum number of enzymatic steps to search.
Default is 20.}

\item{filter}{Optional function to filter generated glycans at each step.
Should take a \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} vector as input and return
a logical vector of the same length.}
}
\value{
An \code{\link[igraph:aaa-igraph-package]{igraph::igraph()}} object representing the synthesis path(s).
Vertices represent glycan structures with \code{name} attribute containing
IUPAC-condensed strings. Edges represent enzymatic reactions with
\code{enzyme} attribute containing gene symbols and \code{step} attribute
indicating the step number. For multiple targets, the graph includes
all synthesis paths needed to reach every target glycan.
}
\description{
Reconstruct the biosynthetic pathway for one or more glycans from a given starting structure
using enzymatic reactions.
This function uses a multi-target breadth-first search to find all feasible pathways
that can synthesize all the target glycans.
}
\details{
For N-glycans, the starting structure is assumed to be "Glc(3)Man(9)GlcNAc(2)",
the N-glycan precursor transfered to Asn by OST.
For O-glycans, the starting structure is assumed to be "GalNAc(a1-".
}
\examples{
library(glyrepr)
library(glyparse)

# Rebuild the biosynthetic pathway of a single glycan
glycan <- "Neu5Ac(a2-3)Gal(b1-4)[Fuc(a1-3)]GlcNAc(b1-3)Gal(b1-3)GalNAc(a1-"
path <- rebuild_biosynthesis(glycan, max_steps = 20)

# Rebuild pathways for multiple glycans
glycans <- c(
  "Neu5Ac(a2-3)Gal(b1-4)[Fuc(a1-3)]GlcNAc(b1-3)Gal(b1-3)GalNAc(a1-",
  "Gal(b1-4)[Fuc(a1-3)]GlcNAc(b1-3)Gal(b1-3)GalNAc(a1-"
)
path <- rebuild_biosynthesis(glycans, max_steps = 20)

# View the path
igraph::as_data_frame(path, what = "edges")

}
