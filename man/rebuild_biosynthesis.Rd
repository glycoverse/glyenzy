% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rebuild-biosynthesis.R
\name{rebuild_biosynthesis}
\alias{rebuild_biosynthesis}
\title{Rebuild the Biosynthetic Path of a Glycan}
\usage{
rebuild_biosynthesis(
  glycan,
  enzymes = NULL,
  max_steps = 20,
  filter = NULL,
  return = c("one", "all")
)
}
\arguments{
\item{glycan}{A \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} scalar, or a character string
supported by \code{\link[glyparse:auto_parse]{glyparse::auto_parse()}}.}

\item{enzymes}{A character vector of gene symbols, or a list of \code{\link[=enzyme]{enzyme()}} objects.
If \code{NULL} (default), all available enzymes will be used.}

\item{max_steps}{Integer, maximum number of enzymatic steps to search.
Default is 20.}

\item{filter}{Optional function to filter generated glycans at each step.
Should take a \code{\link[glyrepr:glycan_structure]{glyrepr::glycan_structure()}} vector as input and return
a logical vector of the same length.}

\item{return}{One of \code{"one"} or \code{"all"}. If \code{"one"}, returns the
first shortest path found. If \code{"all"}, returns a graph containing all
possible paths within \code{max_steps}. Default is \code{"one"}.}
}
\value{
An \code{\link[igraph:aaa-igraph-package]{igraph::igraph()}} object representing the synthesis path(s).
Vertices represent glycan structures with \code{name} attribute containing
IUPAC-condensed strings. Edges represent enzymatic reactions with
\code{enzyme} attribute containing gene symbols and \code{step} attribute
indicating the step number.
}
\description{
Reconstruct the biosynthetic pathway of a glycan from a given starting structure
using enzymatic reactions.
This function uses a combination of depth-first search and heuristics to find a likely pathway,
or all feasible pathways.
}
\details{
For N-glycans, the starting structure is assumed to be "Glc(3)Man(9)GlcNAc(2)",
the N-glycan precursor transfered to Asn by OST.
For O-glycans, the starting structure is assumed to be "GalNAc(a1-".
}
\examples{
library(glyrepr)
library(glyparse)

# Rebuild the biosynthetic pathway of a glycan
glycan <- "Neu5Ac(a2-3)Gal(b1-4)[Fuc(a1-3)]GlcNAc(b1-3)Gal(b1-3)GalNAc(a1-"
path <- rebuild_biosynthesis(glycan, max_steps = 20)

# View the path
igraph::as_data_frame(path, what = "edges")

}
